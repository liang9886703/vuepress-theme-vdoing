<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis | 松垮垮</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="后端开发等技术文章。">
    <meta name="keywords" content="后端博客,个人技术博客,后端,后端开发,后端框架,后端面试题,技术文档,学习,面试,c++,git,github">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.4229948e.css" as="style"><link rel="preload" href="/assets/js/app.41210a84.js" as="script"><link rel="preload" href="/assets/js/2.ddcc22d9.js" as="script"><link rel="preload" href="/assets/js/3.9a514af0.js" as="script"><link rel="preload" href="/assets/js/44.3f5aa743.js" as="script"><link rel="prefetch" href="/assets/js/10.c5ea2586.js"><link rel="prefetch" href="/assets/js/11.345c12e4.js"><link rel="prefetch" href="/assets/js/12.7bd611a3.js"><link rel="prefetch" href="/assets/js/13.e31f4e59.js"><link rel="prefetch" href="/assets/js/14.6cd7ac12.js"><link rel="prefetch" href="/assets/js/15.9d43ec16.js"><link rel="prefetch" href="/assets/js/16.96ef5845.js"><link rel="prefetch" href="/assets/js/17.930177fa.js"><link rel="prefetch" href="/assets/js/18.693f6f3c.js"><link rel="prefetch" href="/assets/js/19.e757fc80.js"><link rel="prefetch" href="/assets/js/20.ed5c437a.js"><link rel="prefetch" href="/assets/js/21.c41265c1.js"><link rel="prefetch" href="/assets/js/22.ed241c46.js"><link rel="prefetch" href="/assets/js/23.7a084215.js"><link rel="prefetch" href="/assets/js/24.2e695667.js"><link rel="prefetch" href="/assets/js/25.3a8e1528.js"><link rel="prefetch" href="/assets/js/26.a630eff6.js"><link rel="prefetch" href="/assets/js/27.a26a85aa.js"><link rel="prefetch" href="/assets/js/28.532ed3b7.js"><link rel="prefetch" href="/assets/js/29.fa09431b.js"><link rel="prefetch" href="/assets/js/30.0fbcfcdc.js"><link rel="prefetch" href="/assets/js/31.b7ca18e2.js"><link rel="prefetch" href="/assets/js/32.51e3797a.js"><link rel="prefetch" href="/assets/js/33.c79407e6.js"><link rel="prefetch" href="/assets/js/34.c1709f1a.js"><link rel="prefetch" href="/assets/js/35.a1680b5b.js"><link rel="prefetch" href="/assets/js/36.4692c6d1.js"><link rel="prefetch" href="/assets/js/37.1caefdec.js"><link rel="prefetch" href="/assets/js/38.158e350f.js"><link rel="prefetch" href="/assets/js/39.a64bf6b9.js"><link rel="prefetch" href="/assets/js/4.ce7d70a4.js"><link rel="prefetch" href="/assets/js/40.def4302a.js"><link rel="prefetch" href="/assets/js/41.d8026554.js"><link rel="prefetch" href="/assets/js/42.496b6914.js"><link rel="prefetch" href="/assets/js/43.67cc445d.js"><link rel="prefetch" href="/assets/js/45.ea91ad4f.js"><link rel="prefetch" href="/assets/js/46.80d186c9.js"><link rel="prefetch" href="/assets/js/47.ecf0e135.js"><link rel="prefetch" href="/assets/js/48.001b8a90.js"><link rel="prefetch" href="/assets/js/49.7d13e977.js"><link rel="prefetch" href="/assets/js/5.a0af7f8a.js"><link rel="prefetch" href="/assets/js/50.c78d144d.js"><link rel="prefetch" href="/assets/js/51.d0c87914.js"><link rel="prefetch" href="/assets/js/52.11fa1467.js"><link rel="prefetch" href="/assets/js/53.f05510d9.js"><link rel="prefetch" href="/assets/js/54.5800936b.js"><link rel="prefetch" href="/assets/js/55.ffc15fea.js"><link rel="prefetch" href="/assets/js/56.88e0791b.js"><link rel="prefetch" href="/assets/js/57.86abaef0.js"><link rel="prefetch" href="/assets/js/58.ccb34ddc.js"><link rel="prefetch" href="/assets/js/59.39016f6c.js"><link rel="prefetch" href="/assets/js/6.2205d704.js"><link rel="prefetch" href="/assets/js/7.6ae52fc4.js"><link rel="prefetch" href="/assets/js/8.8a6895b8.js"><link rel="prefetch" href="/assets/js/9.10468b6d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4229948e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="松垮垮" class="logo"> <span class="site-name can-hide">松垮垮</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="quicker" class="dropdown-title"><a href="/01/" class="link-title">quicker</a> <span class="title" style="display:none;">quicker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01/01/" class="nav-link">vim.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><a href="/02/" class="link-title">分布式</a> <span class="title" style="display:none;">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/02/01/" class="nav-link">一致性算法.md</a></li><li class="dropdown-item"><!----> <a href="/02/02/" class="nav-link">分布式ID生成.md</a></li><li class="dropdown-item"><!----> <a href="/02/03/" class="nav-link">分布式架构.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/03/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03/01/" class="nav-link">css.md</a></li><li class="dropdown-item"><!----> <a href="/03/02/" class="nav-link">html.md</a></li><li class="dropdown-item"><!----> <a href="/03/03/" class="nav-link">JavaScript.md</a></li><li class="dropdown-item"><!----> <a href="/03/04/" class="nav-link">vue.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="操作系统" class="dropdown-title"><a href="/04/" class="link-title">操作系统</a> <span class="title" style="display:none;">操作系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04/01/" class="nav-link">内存管理.md</a></li><li class="dropdown-item"><!----> <a href="/04/02/" class="nav-link">文件系统.md</a></li><li class="dropdown-item"><!----> <a href="/04/03/" class="nav-link">硬件结构.md</a></li><li class="dropdown-item"><!----> <a href="/04/04/" class="nav-link">网络系统.md</a></li><li class="dropdown-item"><!----> <a href="/04/05/" class="nav-link">设备管理.md</a></li><li class="dropdown-item"><!----> <a href="/04/06/" class="nav-link">调试技术.md</a></li><li class="dropdown-item"><!----> <a href="/04/07/" class="nav-link">进程管理.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/05/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/05/01/" class="nav-link">redis原理.md</a></li><li class="dropdown-item"><!----> <a href="/05/02/" class="nav-link">数据库.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务器开发" class="dropdown-title"><a href="/06/" class="link-title">服务器开发</a> <span class="title" style="display:none;">服务器开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06/01/" class="nav-link">nginx.md</a></li><li class="dropdown-item"><!----> <a href="/06/02/" class="nav-link">nginx环境+编译+调试.md</a></li><li class="dropdown-item"><!----> <a href="/06/03/" class="nav-link">高性能linux服务器.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络编程" class="dropdown-title"><a href="/07/" class="link-title">网络编程</a> <span class="title" style="display:none;">网络编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07/01/01/" class="nav-link">IP</a></li><li class="dropdown-item"><!----> <a href="/07/02/" class="nav-link">网络工具.md</a></li><li class="dropdown-item"><!----> <a href="/07/03/" class="nav-link">网络编程.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/08/" class="link-title router-link-active">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08/01/" class="nav-link">GPU并行编程.md</a></li><li class="dropdown-item"><!----> <a href="/08/02/" class="nav-link">mysql.md</a></li><li class="dropdown-item"><!----> <a href="/08/03/" class="nav-link">nginx.md</a></li><li class="dropdown-item"><!----> <a href="/08/04/" aria-current="page" class="nav-link router-link-exact-active router-link-active">redis.md</a></li><li class="dropdown-item"><!----> <a href="/08/05/" class="nav-link">网络.md</a></li><li class="dropdown-item"><!----> <a href="/08/06/" class="nav-link">计算机视觉.md</a></li><li class="dropdown-item"><!----> <a href="/08/07/" class="nav-link">进程管理.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目bug" class="dropdown-title"><a href="/09/" class="link-title">项目bug</a> <span class="title" style="display:none;">项目bug</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/09/01/" class="nav-link">linux调试.md</a></li><li class="dropdown-item"><!----> <a href="/09/02/" class="nav-link">【Python】：re.error bad escape i at position 4.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/liang9886703" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://jsd.cdn.zzko.cn/gh/xugaoyi/image_store/blog/20200103123203.jpg"> <div class="blogger-info"><h3>松垮垮</h3> <span>c++后端开发工程师</span> <span></span> <span></span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="quicker" class="dropdown-title"><a href="/01/" class="link-title">quicker</a> <span class="title" style="display:none;">quicker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/01/01/" class="nav-link">vim.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><a href="/02/" class="link-title">分布式</a> <span class="title" style="display:none;">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/02/01/" class="nav-link">一致性算法.md</a></li><li class="dropdown-item"><!----> <a href="/02/02/" class="nav-link">分布式ID生成.md</a></li><li class="dropdown-item"><!----> <a href="/02/03/" class="nav-link">分布式架构.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/03/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03/01/" class="nav-link">css.md</a></li><li class="dropdown-item"><!----> <a href="/03/02/" class="nav-link">html.md</a></li><li class="dropdown-item"><!----> <a href="/03/03/" class="nav-link">JavaScript.md</a></li><li class="dropdown-item"><!----> <a href="/03/04/" class="nav-link">vue.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="操作系统" class="dropdown-title"><a href="/04/" class="link-title">操作系统</a> <span class="title" style="display:none;">操作系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04/01/" class="nav-link">内存管理.md</a></li><li class="dropdown-item"><!----> <a href="/04/02/" class="nav-link">文件系统.md</a></li><li class="dropdown-item"><!----> <a href="/04/03/" class="nav-link">硬件结构.md</a></li><li class="dropdown-item"><!----> <a href="/04/04/" class="nav-link">网络系统.md</a></li><li class="dropdown-item"><!----> <a href="/04/05/" class="nav-link">设备管理.md</a></li><li class="dropdown-item"><!----> <a href="/04/06/" class="nav-link">调试技术.md</a></li><li class="dropdown-item"><!----> <a href="/04/07/" class="nav-link">进程管理.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/05/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/05/01/" class="nav-link">redis原理.md</a></li><li class="dropdown-item"><!----> <a href="/05/02/" class="nav-link">数据库.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务器开发" class="dropdown-title"><a href="/06/" class="link-title">服务器开发</a> <span class="title" style="display:none;">服务器开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/06/01/" class="nav-link">nginx.md</a></li><li class="dropdown-item"><!----> <a href="/06/02/" class="nav-link">nginx环境+编译+调试.md</a></li><li class="dropdown-item"><!----> <a href="/06/03/" class="nav-link">高性能linux服务器.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络编程" class="dropdown-title"><a href="/07/" class="link-title">网络编程</a> <span class="title" style="display:none;">网络编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07/01/01/" class="nav-link">IP</a></li><li class="dropdown-item"><!----> <a href="/07/02/" class="nav-link">网络工具.md</a></li><li class="dropdown-item"><!----> <a href="/07/03/" class="nav-link">网络编程.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/08/" class="link-title router-link-active">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08/01/" class="nav-link">GPU并行编程.md</a></li><li class="dropdown-item"><!----> <a href="/08/02/" class="nav-link">mysql.md</a></li><li class="dropdown-item"><!----> <a href="/08/03/" class="nav-link">nginx.md</a></li><li class="dropdown-item"><!----> <a href="/08/04/" aria-current="page" class="nav-link router-link-exact-active router-link-active">redis.md</a></li><li class="dropdown-item"><!----> <a href="/08/05/" class="nav-link">网络.md</a></li><li class="dropdown-item"><!----> <a href="/08/06/" class="nav-link">计算机视觉.md</a></li><li class="dropdown-item"><!----> <a href="/08/07/" class="nav-link">进程管理.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目bug" class="dropdown-title"><a href="/09/" class="link-title">项目bug</a> <span class="title" style="display:none;">项目bug</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/09/01/" class="nav-link">linux调试.md</a></li><li class="dropdown-item"><!----> <a href="/09/02/" class="nav-link">【Python】：re.error bad escape i at position 4.md</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/liang9886703" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/08/01/" class="sidebar-link">GPU并行编程</a></li><li><a href="/08/02/" class="sidebar-link">mysql</a></li><li><a href="/08/03/" class="sidebar-link">nginx</a></li><li><a href="/08/04/" aria-current="page" class="active sidebar-link">redis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/08/04/#redis-的瓶颈" class="sidebar-link">redis 的瓶颈</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#哈希表" class="sidebar-link">哈希表</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#int类型" class="sidebar-link">int类型</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#字符串" class="sidebar-link">字符串</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/08/04/#sds方式-存放string类型" class="sidebar-link">SDS方式-存放string类型</a></li><li class="sidebar-sub-header level3"><a href="/08/04/#embstr" class="sidebar-link">embstr</a></li><li class="sidebar-sub-header level3"><a href="/08/04/#raw类型" class="sidebar-link">raw类型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/08/04/#listpack-压缩列表" class="sidebar-link">listpack/压缩列表</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#quicklist紧凑链表" class="sidebar-link">quicklist紧凑链表</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#string" class="sidebar-link">string</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#list" class="sidebar-link">list</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#hash" class="sidebar-link">hash</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#set" class="sidebar-link">set</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#zset" class="sidebar-link">zset</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#bitmap" class="sidebar-link">bitmap</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#主从复制" class="sidebar-link">主从复制</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#哨兵模式" class="sidebar-link">哨兵模式</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#切片集群模式" class="sidebar-link">切片集群模式</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#集群中数据不一致问题" class="sidebar-link">集群中数据不一致问题</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#缓存雪崩" class="sidebar-link">缓存雪崩</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#缓存击穿" class="sidebar-link">缓存击穿</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#缓存穿透" class="sidebar-link">缓存穿透</a></li><li class="sidebar-sub-header level2"><a href="/08/04/#缓存更新" class="sidebar-link">缓存更新</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/08/04/#cache-aside-旁路缓存-策略" class="sidebar-link">Cache Aside（旁路缓存）策略</a></li><li class="sidebar-sub-header level3"><a href="/08/04/#read-write-through-读穿-写穿-策略" class="sidebar-link">Read/Write Through(读穿/写穿)策略</a></li><li class="sidebar-sub-header level3"><a href="/08/04/#write-back-写回-策略" class="sidebar-link">Write Back（写回）策略</a></li></ul></li></ul></li><li><a href="/08/05/" class="sidebar-link">网络</a></li><li><a href="/08/06/" class="sidebar-link">计算机视觉</a></li><li><a href="/08/07/" class="sidebar-link">进程管理</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/08/#面试" data-v-06970110>面试</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/liang9886703" target="_blank" title="作者" class="beLink" data-v-06970110>songkuakua</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2025-02-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">redis<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h1> <p><strong>redis和etcd</strong></p> <p>redis有更好的查询性能，支持更多的数据结构
etcd更为可靠安全，故障转移和持续数据可用，数据均持久化</p> <p>etcd是分布式数据库，强一致。redis是主从复制，最终一致</p> <p><strong>redis和memcached</strong></p> <p>共同点：
两者都是基于内存的数据库，作为缓存使用，有极高的性能
都有过期策略</p> <p>区别：</p> <ul><li>简单的键值存储用memcached更高效，redis支持更多<strong>数据类型</strong>，memcached是kv数据类型</li> <li><strong>redis有</strong>持久化功能，memcached没有</li> <li><strong>高可用</strong>的场景下，redis支持集群模式，memcached没有原生的集群模式</li> <li>redis支持发布订阅模型、lua脚本、事务等功能，memcached不支持</li> <li><strong>精细缓存管理</strong>适用redis，redis能设置更复杂的过期和失效策略</li></ul> <h2 id="redis-的瓶颈"><a href="#redis-的瓶颈" class="header-anchor">#</a> redis 的瓶颈</h2> <ul><li>内存限制，决定了缓存的数据量</li> <li>网络带宽</li> <li>单线程模式</li> <li>cpu限制，高并发的查询下，可能成为瓶颈</li> <li>慢查询</li></ul> <h1 id="物理数据结构"><a href="#物理数据结构" class="header-anchor">#</a> 物理数据结构</h1> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827173615885.png" alt="image-20240827173615885"></p> <p>所有对象都用redisObject结构体保存，存放</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827162719427.png" alt="image-20240827162719427"></p> <h2 id="哈希表"><a href="#哈希表" class="header-anchor">#</a> 哈希表</h2> <p>这里的redisDb就是redisObject，其中ptr指向dict</p> <p>dict里两套哈希表，长期使用导致一个冲突的哈希桶有太多值，需要rehash来定期维护哈希表</p> <h2 id="int类型"><a href="#int类型" class="header-anchor">#</a> int类型</h2> <p>当保存的对象是整数值并可以被long类型识别时</p> <p>直接存到ptr里</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827164330168.png" alt="image-20240827164330168"></p> <h2 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h2> <p><strong>c语言字符串的缺陷</strong></p> <ul><li>不会获取字符串长度</li> <li>只能放文本数据，不能放二进制数据（\0不能有）</li> <li>相关操作函数是不安全、不高效</li></ul> <h3 id="sds方式-存放string类型"><a href="#sds方式-存放string类型" class="header-anchor">#</a> SDS方式-存放string类型</h3> <p>sds分成多种，sdshdr5、sdshdr8、sdshdr16、sdshdr32、dsdhdr64用于存储不同长度的字符串</p> <p>采用SDS结构的编码方式有两种embstr和raw</p> <h3 id="embstr"><a href="#embstr" class="header-anchor">#</a> embstr</h3> <p>存放&lt;=44字节的字符串</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827165226106.png" alt="image-20240827165226106"></p> <h3 id="raw类型"><a href="#raw类型" class="header-anchor">#</a> raw类型</h3> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827165700217.png" alt="image-20240827165700217"></p> <ul><li>embstr一次性分配了一块内存存放object和sds，raw要分配两次。分配释放快，查询快</li> <li>embstr长度增加时需要重新分配sds空间</li> <li>扩容策略：小于1MB，翻倍扩容。超过1MB，依次增加1MB</li></ul> <h2 id="listpack-压缩列表"><a href="#listpack-压缩列表" class="header-anchor">#</a> listpack/压缩列表</h2> <ul><li>用连续的内存空间保存数据，用不同的编码方式保存不同长度的数据，能重复利用内存</li> <li>不可修改，只能新增删除，且增删需要重新分配空间</li> <li>顺序遍历，因此只有少量的数据时才是高效的</li></ul> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827172638509.png" alt="image-20240827172638509"></p> <h2 id="quicklist紧凑链表"><a href="#quicklist紧凑链表" class="header-anchor">#</a> quicklist紧凑链表</h2> <p>直接使用压缩链表，对于元素数量增加或元素变大会造成性能下降。因此使用双向链表+压缩列表</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827173330448.png" alt="image-20240827173330448"></p> <p>即，整体是个双向链表，每个链表节点存放一个压缩链表，当这个节点的压缩链表满了，才生成下一个链表节点</p> <h1 id="用户数据结构"><a href="#用户数据结构" class="header-anchor">#</a> 用户数据结构</h1> <h2 id="string"><a href="#string" class="header-anchor">#</a> string</h2> <p>底层是SDS简单动态字符串</p> <p>应用：</p> <ul><li>缓存对象</li> <li>常规计数</li> <li>分布式锁，单线程的redis，命令为原子的</li> <li>共享session信息</li></ul> <h2 id="list"><a href="#list" class="header-anchor">#</a> list</h2> <p>底层为quicklist</p> <p>应用：消息队列</p> <p>**对于重复消息：**每个消息加上全局ID，同时记录处理过的消息</p> <p>**保证消息可靠：**即消费取出时消费者故障，从list取出同时插入另一个list备份</p> <p>不支持多消费者读同一消息</p> <h2 id="hash"><a href="#hash" class="header-anchor">#</a> hash</h2> <p>底层</p> <ul><li>元素&lt;512个，用listpack</li> <li>其他情况用hash表</li></ul> <p>应用：</p> <ul><li>缓存对象，（对象id，属性，值）</li></ul> <blockquote><p>string+Json也可以存储对象，一般对象中频繁变化的属性可以抽出来用hash储存，便于修改</p></blockquote> <h2 id="set"><a href="#set" class="header-anchor">#</a> set</h2> <p>set只能存储非重复元素，无序存储</p> <p>底层实现：</p> <ul><li>小数据，整数集合</li> <li>其他情况哈希表</li></ul> <p>应用：需要去重，统计交并集</p> <ul><li>点赞</li> <li>共同关注</li> <li>抽奖</li></ul> <h2 id="zset"><a href="#zset" class="header-anchor">#</a> zset</h2> <p>比起set多了排序属性</p> <p>底层实现：</p> <ul><li>小数据，使用listpack压缩列表</li> <li>大数据用跳表</li></ul> <p>应用：</p> <ul><li>排行榜</li> <li>电话、姓名排序</li></ul> <h2 id="bitmap"><a href="#bitmap" class="header-anchor">#</a> bitmap</h2> <p>大量使用二值统计的数据</p> <p>底层：使用string类型作为数据结构</p> <p>应用：</p> <ul><li>签到</li></ul> <h1 id="redis线程模型"><a href="#redis线程模型" class="header-anchor">#</a> redis线程模型</h1> <ul><li>主线程：接收客户端请求-&gt;解析请求-&gt;数据读写-&gt;发送给客户端</li> <li>bio_close_file线程：处理关闭文件</li> <li>bio_aof_fsync线程：负责AOF刷盘</li> <li>bio_lazy_free线程：来释放redis内存</li> <li>三个处理网络I/O的线程</li></ul> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827194516371.png" alt="image-20240827194516371"></p> <p><strong>redis为什么使用单线程：</strong></p> <ul><li>redis的性能瓶颈不是cpu而是内存和网络IO</li> <li>单线程开发更加容易，没有多线程的竞争</li></ul> <p><strong>redis为什么快</strong></p> <ul><li>内存操作+追加读写</li> <li>高效的内存数据结构</li> <li>单线程模型避免了竞争</li></ul> <h1 id="持久化"><a href="#持久化" class="header-anchor">#</a> 持久化</h1> <p><strong>AOF日志格式：</strong></p> <ul><li>日志以追加的形式写入文件</li> <li>先执行，后写日志（可能数据丢失）</li></ul> <p>AOF三种写回策略：</p> <ul><li>每次都同步AOF到磁盘</li> <li>写入缓冲区，每1s同步到磁盘</li> <li>由os决定</li></ul> <p>AOF重写机制：</p> <p>AOF过大时会导致恢复的很慢，因此需要压缩</p> <p>后台子进程完成，用子进程以只读方式访问父进程数据，不需要上锁，读取的数据记录到新的AOF</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827205755855.png" alt="image-20240827205755855"></p> <p>**RDB快照：**对于故障恢复，AOF的恢复方式较慢，RDB记录某一瞬间的内存数据，恢复时直接读入内存，效率更高</p> <p>可以快照记录模式：</p> <ul><li>主线程生成，会阻塞线程</li> <li>创建子进程隔断时间生成RDB（依托写时复制技术，可以边记录边修改数据）</li></ul> <p><strong>混合持久化</strong></p> <p>新的数据先写入AOF，后台进程隔段时间生成RDB快照</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240827211232489.png" alt="image-20240827211232489"></p> <p>整体性能较好，恢复速度快</p> <p>但可读性变差，且不兼容过去的redis版本</p> <h1 id="redis集群"><a href="#redis集群" class="header-anchor">#</a> redis集群</h1> <h2 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> 主从复制</h2> <p>主服务器进行读写操作，写操作写入主服务器后就返回客户端结果，异步同步给从服务器，从服务器只读</p> <p>同步的方式：</p> <ul><li>第一次全量复制。为避免全量复制的节点太多影响主服务器，允许部分从服务器升级为经理角色，执行全量复制</li> <li>主从服务器维持长连接，后面的同步通过命令传播</li> <li>网络断开重连后，增量复制</li></ul> <p><strong>应对主从不一致：</strong></p> <ul><li>让主从节点在同一机房，确保网络状况良好</li> <li>外部程序监控主从节点的复制进度，某个从节点进度差值大于预期，则停止对这个从节点的读</li></ul> <p><strong>应对数据丢失：</strong></p> <p><strong>问题：<strong>主节点写入并返回，但还</strong>没同步给从节点后宕机</strong>，此时主节点的写入数据丢失</p> <p>**解决：**异步复制时，所有从节点写入延迟过高，主节点会拒绝任何请求，此时客户端的数据可以降级写入本地缓存和磁盘，或写入消息队列中</p> <p><strong>问题：主节点和全部从节点失联</strong>，但仍接收客户端请求，哨兵选举出了新的主节点，当主节点恢复时，得知自己降级为从节点，从新的主节点那里得到数据，从而丢失写入的数据</p> <p>**解决：**主节点发现从节点下线数量太多或网络延迟太大，会禁止写入</p> <h2 id="哨兵模式"><a href="#哨兵模式" class="header-anchor">#</a> 哨兵模式</h2> <p>对于主从模式，如果主节点宕机了，需要能选举出新的主节点</p> <p><strong>主节点宕机</strong>：哨兵集群（至少三个）通过心跳感知主节点状态，当一个哨兵判断主节点主观下线后，向其他哨兵发起投票，判断是否客观下线</p> <p><strong>选举哨兵leader</strong>：哨兵集群认为主节点下线后，发起投票的哨兵会成为候选人，向其他哨兵发起当选leader投票，已经投票的哨兵不会再次投票，因此一定会选举出leader哨兵</p> <p><strong>哨兵leader选举主节点：</strong></p> <ol><li>过滤网络不好的节点：主从节点一定时间内断连次数过高</li> <li>依次对比：优先级-日志数量-ID号</li></ol> <p><strong>哨兵leader通知主节点当选：</strong></p> <ol><li>以1s的频率向当选从节点发送当选命令</li> <li>向所有从节点发送新主节点</li> <li>通过发布订阅模式通知客户端主节点更换</li> <li>当旧主节点上线时通知其成为从节点</li></ol> <p><strong>哨兵集群如何组织：</strong></p> <p>通过redis的发布/订阅机制，哨兵将自己的IP地址和端口信息发布到主节点的频道上，建立连接</p> <p>哨兵每10s一次从主节点那获取所有从节点的信息后，和从节点建立连接</p> <h2 id="切片集群模式"><a href="#切片集群模式" class="header-anchor">#</a> 切片集群模式</h2> <p>对于超大的数据，使用集群模式将数据分布在不同的服务器上</p> <h2 id="集群中数据不一致问题"><a href="#集群中数据不一致问题" class="header-anchor">#</a> 集群中数据不一致问题</h2> <p>read from master：只从主节点读</p> <p>lua脚本/分布式事务：保证多个操作的一致性</p> <p>外部协调：zookeeper、etcd提供强一致性的锁和协调机制</p> <h1 id="过期删除策略"><a href="#过期删除策略" class="header-anchor">#</a> 过期删除策略</h1> <p>对于一些key设置了过期时间，使用<code>惰性删除+定期删除</code>的删除策略</p> <p>定时删除：（redis没有）每个数据都定时一个删除任务</p> <p>**惰性删除：**每次数据库访问key时，检查是否过期，过期删除（性能好，但没有及时删除，有内存浪费）</p> <p>**定期删除：**定时检查一定数量的key执行删除</p> <ol><li>随机抽20个key检查并执行过期删除</li> <li>过期的数量超过1/4，则重复步骤1，否则停止</li> <li>循环上限不超过25ms</li></ol> <p>持久化为RDB文件或通过RDB文件加载时，会对每个键作过期检查</p> <p>持久化AOF文件，删除操作会追加一条删除命令写入</p> <p>从库通过主库发出的del命令执行删除</p> <h1 id="内存淘汰策略"><a href="#内存淘汰策略" class="header-anchor">#</a> 内存淘汰策略</h1> <p>提供8种内存淘汰策略</p> <ol><li>不淘汰，内存满了不提供服务</li> <li>在设置了过期时间的数据中进行淘汰：任意、ttl（更早过期）、lru、lfu</li> <li>在所有数据范围内进行淘汰：任意、lru、lfu</li></ol> <p>LRU机制：随机取5个值，淘汰最久没用的</p> <p>（不用维护链表）</p> <p>LFU（ Least Frequently Used）机制：记录每个数据的访问时间和访问频次logc</p> <ol><li>访问key时，先根据距离上次访问时间的时长，衰减logc（越久衰减越多）</li> <li>再按一定概率增加logc（越大增加越少）</li></ol> <h1 id="redis缓存"><a href="#redis缓存" class="header-anchor">#</a> redis缓存</h1> <p>作为缓存数据库，业务先访问缓存数据库再访问数据库</p> <h2 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h2> <p>问题：大量缓存同时过期，导致大量用户请求直接访问后台数据库</p> <p>解决：</p> <ul><li>打散缓存失效时间</li> <li>互斥锁：一个请求发现数据不在redis里，就加互斥锁，构建缓存后释放锁。没抢到锁的请求返回NULL或默认值</li> <li>缓存不过期，通过后台服务更新缓存数据。（（定时检查或访问时通知）感知到缓存被淘汰了，后台线程重新加载缓存）</li></ul> <p>问题：redis宕机,导致大量用户请求直接访问后台数据库</p> <p>解决：</p> <ul><li>熔断或限流</li> <li>构建redis集群</li></ul> <h2 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h2> <p>问题：热点数据过期了，大量请求访问热点数据未命中缓存从而访问后台数据库</p> <p>同缓存雪崩</p> <h2 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h2> <p>问题：大量的请求访问的数据既不在缓存也不在数据库</p> <ul><li>黑客攻击</li> <li>业务误删除数据</li></ul> <p>解决：</p> <ul><li>限制非法请求</li> <li>对一些数据设置空值，从缓存中读到空值</li> <li>布隆过滤器快速判断数据是否存在</li></ul> <p>布隆过滤器：对数据通过多个hash函数计算并映射到位图上。存在误判没数据为有数据的可能，但能得到部分数据不存在的信息，从而降低缓存穿透的概率</p> <h2 id="缓存更新"><a href="#缓存更新" class="header-anchor">#</a> 缓存更新</h2> <h3 id="cache-aside-旁路缓存-策略"><a href="#cache-aside-旁路缓存-策略" class="header-anchor">#</a> Cache Aside（旁路缓存）策略</h3> <p>写：先写数据库，再删除缓存</p> <p>读：先查缓存，再查询数据库并更新缓存</p> <p>如果交换数据库和缓存的查询/写入顺序会增大数据不一致的概率（一次读写操作被外部分成了几部分，每部分的执行顺序不确定，因此会有不一致的问题）</p> <p><img src="/%E9%9D%A2%E8%AF%95/image-20240828172654970.png" alt="image-20240828172654970"></p> <p>大多时候②的写会很慢，因此③总能在④前执行，从而降低了数据不一致的概率</p> <p>如果要彻底解决：</p> <ul><li>分布式锁，一次一个线程更新</li> <li>缓存上租约，不一致的缓存会很快过期</li></ul> <p>适用读多写少</p> <h3 id="read-write-through-读穿-写穿-策略"><a href="#read-write-through-读穿-写穿-策略" class="header-anchor">#</a> Read/Write Through(读穿/写穿)策略</h3> <p>读写经过缓存，缓存组件更新数据库</p> <p>读写操作被缓存组件确定了顺序，以缓存数据为准，所以不会出现不一致</p> <blockquote><p>实际开发中，常用的分布式缓存组件都不支持和数据库交换，因此使用较少。etcd是这么做的，适用自己开发的组件</p></blockquote> <h3 id="write-back-写回-策略"><a href="#write-back-写回-策略" class="header-anchor">#</a> Write Back（写回）策略</h3> <p>对于写只更新缓存，后台异步批量更新数据库</p> <ul><li>适用读少写多，例如os的文件系统</li> <li>不是强一致性的，断电会数据丢失</li></ul> <h1 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h1> <p>**如何处理大key **</p> <p>问题：</p> <ul><li>单线程处理大key会阻塞客户端</li> <li>网卡阻塞，消息丢失</li> <li>阻塞服务器处理线程</li> <li>分片集群模式下内存分布不均</li></ul> <p>通过工具能找到大key，但会占用较多cpu资源</p> <p>删除大key：</p> <ul><li>分批次删除</li></ul> <p>​	如果一次删除全部大key，涉及内存释放，易阻塞</p> <p>​	一次删除一个字段</p> <ul><li>异步删除</li></ul> <p><strong>redis管道</strong>：能一次处理多个redis命令，整合后一并发送给服务端</p> <p><strong>redis实现分布式锁：</strong></p> <p><strong>加锁：</strong></p> <p>如果不存在这个key， 对这个key写入自己客户端的id，设置租约10s</p> <p>**解锁：**比较这个key的值是自己客户端的id，则删除这个key</p> <p>优点：性能高效、避免单点故障、开发方便</p> <p>缺点：租约时间不好设置、主从复制使得分布式锁不可靠</p> <p><strong>红锁：</strong></p> <p>部署多个主redis节点，客户端依次向多个主redis写入加锁，</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/liang9886703/edit/master/docs/08.面试/04.redis.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/02/13, 23:35:20</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/08/03/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">nginx</div></a> <a href="/08/05/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">网络</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/08/03/" class="prev">nginx</a></span> <span class="next"><a href="/08/05/">网络</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/02/01/"><div>
            一致性算法
            <!----></div></a> <span class="date">02-13</span></dt></dl><dl><dd>02</dd> <dt><a href="/01/01/"><div>
            vim
            <!----></div></a> <span class="date">02-13</span></dt></dl><dl><dd>03</dd> <dt><a href="/02/02/"><div>
            分布式ID生成
            <!----></div></a> <span class="date">02-13</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:liang9886703@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/liang9886703" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2025-2025
    <span>松垮垮 | <a href="https://github.com/liang9886703/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a> | <a href="http://beian.miit.gov.cn/" target="_blank">蜀ICP备2025120453号</a> | <img src="/img/beian.png" style="width: 15px; margin-bottom: -3px;" /> <a href="https://beian.mps.gov.cn/#/query/webSearch?code=51011202000997" rel="noreferrer" target="_blank">川公网安备51011202000997号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          纯净模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center  top / 90% 90% no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.41210a84.js" defer></script><script src="/assets/js/2.ddcc22d9.js" defer></script><script src="/assets/js/3.9a514af0.js" defer></script><script src="/assets/js/44.3f5aa743.js" defer></script>
  </body>
</html>
