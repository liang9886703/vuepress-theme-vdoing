(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{420:function(e,v,_){"use strict";_.r(v);var t=_(7),r=Object(t.a)({},(function(){var e=this,v=e._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("hr"),e._v(" "),v("p",[e._v("title: 【Python】：re.error bad escape i at position 4\ndate: 2025-02-08 13:57:30\npermalink: /项目bug/【Python】：re.error bad escape i at position 4\ncategories:")]),e._v(" "),v("ul",[v("li",[e._v("项目bug\ntags:\nauthor:\nname: songkuakua\nlink: https://github.com/liang9886703")])]),e._v(" "),v("hr"),e._v(" "),v("h1",{attrs:{id:"问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[e._v("#")]),e._v(" 问题")]),e._v(" "),v("p",[e._v("报错"),v("code",[e._v("bad escape /i at position 4.md")])]),e._v(" "),v("h1",{attrs:{id:"原因"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#原因"}},[e._v("#")]),e._v(" 原因")]),e._v(" "),v("p",[e._v("错误为尝试编译一个包含不当转义字符的正则表达式时。具体来说，\\z在正则表达式中并不是一个有效的转义序列，这就导致了编译错误。")]),e._v(" "),v("p",[e._v("正则表达式的re库执行前，会触发python解析字符串，python发现了无效的字符串从而抛出错误，表面上是re库抛出的，实际上是python解析字符串是抛出的错误")]),e._v(" "),v("p",[e._v("只是简单的字符串赋值、输出等不会触发字符串解析，同样的可能会触发python解析字符串的场景：")]),e._v(" "),v("ul",[v("li",[v("code",[e._v("re")]),e._v(" 正则表达式")]),e._v(" "),v("li",[v("code",[e._v("open()")]),e._v(" 读取文件路径")]),e._v(" "),v("li",[v("code",[e._v("json")]),e._v(" 解析字符串")]),e._v(" "),v("li",[v("code",[e._v("eval()")]),e._v(" 解析字符串")])]),e._v(" "),v("p",[e._v("再来看python解析字符串的规则")]),e._v(" "),v("p",[v("code",[e._v("'C:\\user'")]),e._v("显然不行，"),v("code",[e._v("\\u")]),e._v("被视为转义字符，"),v("code",[e._v("'C:\\\\user'")]),e._v("也不行就很诡异了，据说"),v("code",[e._v("\\u")]),e._v("会先被解析导致的，"),v("code",[e._v("'C:\\\\\\\\user'")]),e._v("会被解析为两个"),v("code",[e._v("\\")]),e._v("所以没事")]),e._v(" "),v("h1",{attrs:{id:"解决"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[e._v("#")]),e._v(" 解决")]),e._v(" "),v("p",[e._v("首先想到用"),v("code",[e._v("re.escape()")]),e._v("将输入的字符手动转义")]),e._v(" "),v("p",[e._v("但是这样替换的结果会带上转义后的内容")]),e._v(" "),v("p",[e._v("例如：")]),e._v(" "),v("p",[v("code",[e._v("re.sub( r'C:',re.escape('C:\\ser'),r'C:',1)")])]),e._v(" "),v("p",[e._v("输出："),v("code",[e._v("'C:\\\\ser'")]),e._v("，期望的输出为"),v("code",[e._v("'C:\\ser'")])]),e._v(" "),v("p",[e._v("因此只好先编码用re替换后，再解码")])])}),[],!1,null,null,null);v.default=r.exports}}]);