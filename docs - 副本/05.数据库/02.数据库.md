---
title: 数据库
date: 2025-02-13 23:10:50
permalink: /05/02
categories: 
  - 05
tags: 
author:
  name: songkuakua
  link: https://github.com/liang9886703
---
# memcached

开源的、高性能、具有分布式内存对象的缓存系统，

- kv缓存
- 协议简单
- 不持久化
- 没有安全机制
- 互不通信的memcached有分布式特征

# 三大范式

## 意义

避免数据冗余、

提高查询和更新效率：数据冗余使得更新某个数据需要修改多行数据（例如某课程的学分），如果分表了只需修改一行

数据一致性、完整性：更新某个数据需要修改多个学生的信息，那么修改的过程中会出现有些学生查到的是新的，有些学生查到的是旧的



## 原理

### 第一范式（1NF）原子性：

表中每一列信息都不可再分

### 第二范式（2NF）唯一性：

通过一个主键字段或者一个联合主键字段可以唯一确定一行，且表中其他非主键字段一定完全依赖所有主键字段，而不是部分依赖

例如：![image-20241029160023462](/数据库/./image-20241029160023462.png)

对于这个表，通过学生和课程可以唯一确定一行，联合主键索引（学生、课程）。但学分依赖于课程，不依赖学生。成绩依赖学生不依赖课程，因此不满足第二范式。

分表修改如下

![image-20241029160316958](/数据库/./image-20241029160316958.png)

### 第三范式（3NF）独立性：

对于非主键索引之间，不能有依赖性

例如：![image-20241029160545368](/数据库/./image-20241029160545368.png)

表中学生id作为主键唯一确定一行，满足第一范式和第二范式，但非主键中院系电话依赖于院系，因此不满足第三范式

修改如下：

![image-20241029160812364](/数据库/./image-20241029160812364.png)

# 分库分表

分库：单一数据库的连接量，读写性能达上限，需要分库

分表：

- 数据量过大，超过三层b+树索引，



## 垂直分库

将一个库的表按照业务类型拆分到多个库，每个库的表不一样

- 降低单库压力
- 各系统间解耦

需要考虑数据一致性，引入分布式事务

跨库多表join问题：

- 需要join的字典不拆表
- 对join字段冗余

## 垂直分表

拆分表结构，按照范式原则拆分一个表为多个子表

- 提高缓存命中率，（数据库以行为单位缓存数据，拆分后可以只缓存访问频率高的字段，从而能缓存更多数据）
- 提高查询更新效率
- 降低数据冗余
- 保证数据一致性

## 水平分库

用哈希映射，将不同数据映射到不同库，从而支持大规模数据存储

- 提高集群并发能力

单库的自增ID需要引入分布式自增ID

## 水平分表

同一库内，将单表按数据拆分为多个表

- 降低单表数据量，降低b+树高度，提高查询速度
- 











































